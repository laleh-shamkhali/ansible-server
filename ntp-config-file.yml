---
- hosts: all

  tasks:
  - name: Commenting default server config using the regualr expressions in Ansible.
    replace:
      path: /etc/ntp.conf
      regexp: '(.*centos.pool.ntp.org.*)'
      replace: '#\1'

  - name: "Example1: Validate if a String or line is present in the file"
    become: yes
    tags: lineinfilecentospool
    lineinfile:
      path: /etc/ntp.conf
      insertafter: "(.*3.centos.pool.ntp.org.*)" 
      line: "server XXX.XXX.XXX.XXX iburst"
      firstmatch: yes
      state: present  
      
  - name: Restart service httpd, in all cases
    service:
      name: ntpd
      state: restarted

